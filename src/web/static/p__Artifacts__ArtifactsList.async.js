"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8683],{99003:function(G,M,t){t.r(M);var g=t(9783),x=t.n(g),O=t(97857),c=t.n(O),p=t(15009),d=t.n(p),N=t(99289),T=t.n(N),J=t(5574),m=t.n(J),A=t(62832),Q=t(55932),V=t(80882),X=t(48115),k=t(63606),w=t(57132),q=t(48689),ee=t(68795),te=t(90930),j=t(88026),D=t(2453),I=t(66309),h=t(83622),R=t(98081),ne=t(86738),ae=t(25278),re=t(74330),_e=t(61182),se=t(32983),oe=t(27484),B=t.n(oe),l=t(67294),r=t(85893),ue=function(){var ie=(0,l.useState)(!0),L=m()(ie,2),de=L[0],U=L[1],le=(0,l.useState)({current:1,pageSize:10}),b=m()(le,2),ce=b[0],me=b[1],K=(0,j.useParams)(),E=K.project_name,P=K.repository_name,Ee=(0,l.useState)(0),S=m()(Ee,2),fe=S[0],ve=S[1],pe=(0,l.useState)([]),W=m()(pe,2),De=W[0],he=W[1],Pe=(0,l.useState)(""),Z=m()(Pe,2),C=Z[0],Ce=Z[1],Me=(0,l.useState)({}),z=m()(Me,2),ge=z[0],Oe=z[1],ye=(0,l.useState)(!1),F=m()(ye,2),Y=F[0],H=F[1],y=function(){var s=T()(d()().mark(function e(){var n,_,a,i,o,u=arguments;return d()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return n=u.length>0&&u[0]!==void 0?u[0]:1,_=u.length>1&&u[1]!==void 0?u[1]:10,U(!0),f.next=5,A.Z.ArtifactsController.get_artifacts(E||"",encodeURIComponent(encodeURIComponent(P||"")),C?"digest".concat(encodeURIComponent("="),"~").concat(C):"",_,n);case 5:a=f.sent,i=a.code,o=a.data,i==200?(he(o),C&&ve(o.length)):D.ZP.error("\u83B7\u53D6".concat(E,"\u4ED3\u5E93\u5236\u54C1\u5931\u8D25")),U(!1);case 10:case"end":return f.stop()}},e)}));return function(){return s.apply(this,arguments)}}(),xe=function(e,n){me({current:e,pageSize:n}),y(e,n)},$=function(e){Oe(function(n){return c()(c()({},n),{},x()({},e,!n[e]))})},Te=function(e,n){if(e){var _=e.map(function(v){return v.name}),a=ge[n]||!1,i=3,o=a?_:_.slice(0,i),u=_.length-i;return(0,r.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px",alignItems:"center"},children:[o.map(function(v,f){return(0,r.jsx)(I.Z,{color:"blue",style:{margin:0},children:v},f)}),!a&&u>0&&(0,r.jsxs)(h.ZP,{type:"link",size:"small",onClick:function(){return $(n)},icon:(0,r.jsx)(V.Z,{}),style:{padding:"0 4px",height:"auto",fontSize:"12px"},children:["\u66F4\u591A(",u,")"]}),a&&(0,r.jsx)(h.ZP,{type:"link",size:"small",onClick:function(){return $(n)},icon:(0,r.jsx)(X.Z,{}),style:{padding:"0 4px",height:"auto",fontSize:"12px"},children:"\u6536\u8D77"})]})}};(0,l.useEffect)(function(){y()},[C]);var Ae=function(e){return navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(e):new Promise(function(n,_){var a=document.createElement("textarea");a.value=e,a.style.position="fixed",a.style.top="-9999px",a.style.left="-9999px",a.style.opacity="0",document.body.appendChild(a),a.focus(),a.select();try{var i=document.execCommand("copy");i?n():_(new Error("\u590D\u5236\u5931\u8D25"))}catch(o){_(o)}finally{document.body.removeChild(a)}})},je=function(e){var n="";e.type=="CHART"?n="helm pull oci://kubekylin.io/".concat(E,"/").concat(P," --version ").concat(e.extra_attrs.version):n="ctr i pull kubekylin.io/".concat(E,"/").concat(P,"@").concat(e.digest),Ae(n).then(function(){H(!0),setTimeout(function(){return H(!1)},2e3),D.ZP.success("".concat(n," \u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F"))}).catch(function(_){console.error("\u590D\u5236\u5931\u8D25:",_);var a=document.querySelector("pre");if(a){var i=document.createRange();i.selectNodeContents(a);var o=window.getSelection();o==null||o.removeAllRanges(),o==null||o.addRange(i)}D.ZP.error("\u81EA\u52A8\u590D\u5236\u5931\u8D25\uFF0C\u8BF7\u624B\u52A8\u590D\u5236\u5185\u5BB9")})},Ie=function(){var s=T()(d()().mark(function e(n){var _,a,i;return d()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,A.Z.ArtifactsController.del_artifact(E||"",encodeURIComponent(encodeURIComponent(P||"")),n||"");case 2:_=u.sent,a=_.code,i=_.data,a==200?(D.ZP.success("\u5236\u54C1\u5220\u9664\u6210\u529F"),y()):D.ZP.error("\u83B7\u53D6".concat(E,"\u4ED3\u5E93\u5236\u54C1\u5931\u8D25"));case 6:case"end":return u.stop()}},e)}));return function(n){return s.apply(this,arguments)}}(),Re=[{title:"\u5236\u54C1\u540D\u79F0",dataIndex:"digest",key:"digest",width:150,render:function(e,n){return(0,r.jsxs)(R.Z,{children:[(0,r.jsx)(h.ZP,{type:"link",onClick:function(){var a=encodeURIComponent(P||"");j.history.push("/artifacts/detail/".concat(E,"/").concat(a,"/").concat(e))},children:e}),(0,r.jsx)(h.ZP,{icon:Y?(0,r.jsx)(k.Z,{}):(0,r.jsx)(w.Z,{}),onClick:function(){return je(n)},children:Y?"\u5DF2\u590D\u5236":"\u590D\u5236\u62C9\u53D6\u547D\u4EE4"})]})}},{title:"\u7C7B\u578B",dataIndex:"type",key:"type",width:100,render:function(e){return(0,r.jsx)(I.Z,{color:e=="CHART"?"cyan":"blue",children:e})}},{title:"tags",dataIndex:"tags",key:"tags",width:150,render:function(e,n){return Te(e,n)}},{title:"\u5927\u5C0F",dataIndex:"size",key:"size",width:100,render:function(e){var n=(0,Q.t)(e);return"".concat(n.value).concat(n.unit)}},{title:"\u63A8\u9001\u65F6\u95F4",dataIndex:"push_time",key:"push_time",width:150,render:function(e){return B()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:"\u62C9\u53D6\u65F6\u95F4",dataIndex:"pull_time",key:"pull_time",width:150,render:function(e){return B()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:"\u64CD\u4F5C",key:"action",width:200,render:function(e,n){return(0,r.jsx)(R.Z,{size:"small",children:(0,r.jsx)(ne.Z,{title:"\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u4E2A\u955C\u50CF\u5417\uFF1F",onConfirm:function(){return Ie(n.digest)},okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",children:(0,r.jsx)(h.ZP,{type:"text",size:"small",icon:(0,r.jsx)(q.Z,{}),danger:!0,children:"\u5220\u9664"})})})}}];return(0,r.jsxs)(te._z,{children:[(0,r.jsx)("div",{style:{marginBottom:16,display:"flex",gap:8},children:(0,r.jsx)(ae.Z,{placeholder:"\u641C\u7D22\u5236\u54C1\u540D\u79F0",prefix:(0,r.jsx)(ee.Z,{}),value:C,onChange:function(e){return Ce(e.target.value)},style:{width:300}})}),(0,r.jsx)(re.Z,{spinning:de,children:(0,r.jsx)(_e.Z,{dataSource:De,columns:Re,rowKey:"id",pagination:c()(c()({},ce),{},{showSizeChanger:!0,total:fe,onChange:xe}),scroll:{x:1100},size:"middle",locale:{emptyText:(0,r.jsx)(se.Z,{description:"\u6682\u65E0\u5236\u54C1\u6570\u636E"})}})})]})};M.default=ue},55932:function(G,M,t){t.d(M,{t:function(){return g}});var g=function(O){for(var c=["B","Ki","Mi","Gi","Ti"],p=O,d=0;p>=1024&&d<c.length-1;)p/=1024,d++;return{value:Number(p.toFixed(2)),unit:c[d]}}}}]);
