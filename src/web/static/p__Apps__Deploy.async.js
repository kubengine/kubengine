"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6349],{77901:function(oe,W,e){e.r(W);var j=e(13769),l=e.n(j),L=e(15009),_=e.n(L),B=e(99289),f=e.n(B),U=e(5574),b=e.n(U),T=e(62832),y=e(90930),A=e(88026),v=e(2453),I=e(67294),R=e(96577),D=e(85893),K=["helm_chart","name","helm_chart_version","app_id"],s=function(){var t=(0,I.useState)(!1),u=b()(t,2),o=u[0],n=u[1],x=(0,A.useParams)(),E=x.app_id,c=(0,I.useState)({name:"",category:[],description:"",helm_chart:"",app_field_configs:[]}),r=b()(c,2),w=r[0],N=r[1],S=function(){var $=f()(_()().mark(function p(){var g,M,C;return _()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return n(!0),m.next=3,T.Z.AppsController.get_app_by_id(E);case 3:g=m.sent,M=g.code,C=g.data,M==200&&N(C),n(!1);case 8:case"end":return m.stop()}},p)}));return function(){return $.apply(this,arguments)}}();(0,I.useEffect)(function(){S()},[E]);var G=function(){var $=f()(_()().mark(function p(g){var M,C;return _()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,T.Z.AppsController.deploy(g);case 2:M=m.sent,C=M.code,C==200&&(v.ZP.success("\u63D0\u4EA4\u90E8\u7F72\u8BF7\u6C42\u6210\u529F"),A.history.push("/apps/cluster"));case 5:case"end":return m.stop()}},p)}));return function(g){return $.apply(this,arguments)}}();return(0,D.jsx)(y._z,{loading:o,children:(0,D.jsx)(R.t,{app:w,submit:function(p){var g=p.helm_chart,M=p.name,C=p.helm_chart_version,i=p.app_id,m=l()(p,K);G({app_id:i,helm_chart:g,name:M,helm_chart_version:C,config:m})}})})};W.default=s},96577:function(oe,W,e){e.d(W,{t:function(){return a}});var j=e(15009),l=e.n(j),L=e(97857),_=e.n(L),B=e(99289),f=e.n(B),U=e(5574),b=e.n(U),T=e(62832),y=e(88245),A=e(86587),v=e(96074),I=e(98081),R=e(83622),D=e(67294),K=e(65136),s=e(85893),a=function(u){var o=u.app,n=u.submit,x=(0,D.useState)({basic:!1,cluster:!1,env:!1}),E=b()(x,2),c=E[0],r=E[1],w=A.Z.useForm(),N=b()(w,1),S=N[0],G=A.Z.useForm(),$=b()(G,1),p=$[0],g=A.Z.useForm(),M=b()(g,1),C=M[0],i=(0,D.useState)(!1),m=b()(i,2),F=m[0],Y=m[1],J=(0,D.useState)(),Q=b()(J,2),te=Q[0],k=Q[1],ae=function(){var h=f()(l()().mark(function d(){var q,z,V,ee,re,H;return l()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return X.next=2,Promise.all([S.validateFields().catch(function(P){Promise.reject({form:"basic",error:P})}),p.validateFields().catch(function(P){return Promise.reject({form:"cluster",error:P})}),C.validateFields().catch(function(P){return Promise.reject({form:"env",error:P})})]).catch(function(P){throw P});case 2:q=X.sent,z=b()(q,3),V=z[0],ee=z[1],re=z[2],Y(!0),H=_()(_()(_()({},V),ee),re),n&&n(H),Y(!1);case 11:case"end":return X.stop()}},d)}));return function(){return h.apply(this,arguments)}}(),ne=function(){var h=f()(l()().mark(function d(){var q,z,V,ee,re,H,Z=arguments;return l()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return q=Z.length>0&&Z[0]!==void 0?Z[0]:1,z=Z.length>1&&Z[1]!==void 0?Z[1]:100,P.next=4,T.Z.ArtifactsController.get_artifacts("charts",encodeURIComponent(encodeURIComponent(o.helm_chart)),"",z,q);case 4:V=P.sent,ee=V.code,re=V.data,ee==200&&(H=re.filter(function(O){var le,ie;return(O==null||(le=O.extra_attrs)===null||le===void 0?void 0:le.appVersion)&&(O==null||(ie=O.extra_attrs)===null||ie===void 0?void 0:ie.version)&&(O==null?void 0:O.digest)}).map(function(O){return{label:"".concat(O.extra_attrs.version," (appVersion:").concat(O.extra_attrs.appVersion,")"),value:O.extra_attrs.version}}),H.length>0&&k(H));case 8:case"end":return P.stop()}},d)}));return function(){return h.apply(this,arguments)}}();(0,D.useEffect)(function(){o.helm_chart&&o.helm_chart!=""&&ne()},[o]);var se=[{name:"app_id",label:"app_id",type:"text",initial_value:o.app_id,config_type:"",extra:"",order:0,form_item_props:{hidden:!0},rules:[],field_props:{}},{name:"helm_chart",label:"helm_chart",type:"text",initial_value:o.helm_chart,config_type:"",extra:"",order:1,form_item_props:{hidden:!0},rules:[],field_props:{}},{name:"name",label:"name",type:"text",initial_value:o.name,extra:"\u5E94\u7528\u670D\u52A1\u7684\u540D\u79F0",order:2,config_type:"",form_item_props:{required:!0},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5E94\u7528\u540D\u79F0"},{min:2,message:"\u5E94\u7528\u540D\u81F3\u5C112\u4E2A\u5B57\u7B26"}],field_props:{}},{name:"helm_chart_version",label:"version",type:"select",order:3,extra:"\u9009\u62E9\u90E8\u7F72\u4F7F\u7528\u7684helm\u6A21\u677F\u7248\u672C",config_type:"",initial_value:"",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u90E8\u7F72\u4F7F\u7528\u7684helm\u6A21\u677F\u7248\u672C"}],field_props:{options:te},form_item_props:{required:!0}}];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(y.Z,{loading:F,title:"\u7B2C 1 \u6B65: \u57FA\u672C\u8BBE\u7F6E",extra:(0,s.jsx)("a",{onClick:function(){return r(function(d){return _()(_()({},d),{},{basic:!d.basic})})},children:c.basic?"\u5C55\u5F00\u914D\u7F6E":"\u6536\u8D77\u914D\u7F6E"}),style:{marginBlockStart:16},headerBordered:!0,collapsed:c.basic,children:(0,s.jsx)(K.Z,{labelCol:{span:4},wrapperCol:{span:14},style:{maxWidth:700},form:S,fields:se})}),(0,s.jsx)(y.Z,{title:"\u7B2C 2 \u6B65: \u96C6\u7FA4\u89C4\u683C",loading:F,extra:(0,s.jsx)("a",{onClick:function(){return r(function(d){return _()(_()({},d),{},{cluster:!d.cluster})})},children:c.cluster?"\u5C55\u5F00\u914D\u7F6E":"\u6536\u8D77\u914D\u7F6E"}),style:{marginBlockStart:16},headerBordered:!0,collapsed:c.cluster,children:(0,s.jsx)(K.Z,{labelCol:{span:4},wrapperCol:{span:14},form:p,style:{maxWidth:700},fields:(o.app_field_configs.filter(function(h){return h.config_type=="cluster"})||[]).sort(function(h,d){return h.order-d.order})})}),(0,s.jsx)(y.Z,{title:"\u7B2C 3 \u6B65: \u670D\u52A1\u73AF\u5883\u53C2\u6570\u8BBE\u7F6E",loading:F,extra:(0,s.jsx)("a",{onClick:function(){return r(function(d){return _()(_()({},d),{},{env:!d.env})})},children:c.env?"\u5C55\u5F00\u914D\u7F6E":"\u6536\u8D77\u914D\u7F6E"}),style:{marginBlockStart:16},headerBordered:!0,collapsed:c.env,children:(0,s.jsx)(K.Z,{labelCol:{span:4},wrapperCol:{span:14},form:C,style:{maxWidth:700},fields:(o.app_field_configs.filter(function(h){return h.config_type=="env"})||[]).sort(function(h,d){return h.order-d.order})})}),n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v.Z,{}),(0,s.jsxs)(I.Z,{size:"large",children:[(0,s.jsx)(R.ZP,{type:"primary",size:"large",onClick:ae,loading:F,children:"\u63D0\u4EA4"}),(0,s.jsx)(R.ZP,{size:"large",children:"\u53D6\u6D88"})]})]}):(0,s.jsx)(s.Fragment,{})]})}},65136:function(oe,W,e){var j=e(97857),l=e.n(j),L=e(13769),_=e.n(L),B=e(25278),f=e(13457),U=e(34041),b=e(78045),T=e(72269),y=e(86587),A=e(67294),v=e(85893),I=["form","fields"],R=["placeholder","prefix","allowClear","showCount","min","max","step","options","selectMode","uploadAction","accept","variant","checkboxOptions"],D=function(s){var a=s.form,t=s.fields,u=_()(s,I),o=function(x){if(x!=null){var E=x.type,c=x.field_props,r=c===void 0?{}:c;switch(E){case"text":return(0,v.jsx)(B.Z,l()({placeholder:r.placeholder,allowClear:r.allowClear,prefix:r.prefix,variant:r.variant},r));case"password":return(0,v.jsx)(B.Z.Password,l()({placeholder:r.placeholder,allowClear:r.allowClear,variant:r.variant},r));case"textarea":return(0,v.jsx)(B.Z.TextArea,l()({placeholder:r.placeholder,allowClear:r.allowClear,showCount:r.showCount,variant:r.variant,rows:4},l()(l()({},r),{},{prefix:void 0})));case"number":return(0,v.jsx)(f.Z,l()({placeholder:r.placeholder,min:r.min,max:r.max,step:r.step,style:{width:"100%"},variant:r.variant},r));case"select":return(0,v.jsx)(U.Z,l()({placeholder:r.placeholder,allowClear:r.allowClear,mode:r.mode,options:r.options},r));case"radio":return(0,v.jsx)(b.ZP.Group,l()({options:r.options,disabled:r.disabled},r));case"switch":var w=r.placeholder,N=r.prefix,S=r.allowClear,G=r.showCount,$=r.min,p=r.max,g=r.step,M=r.options,C=r.selectMode,i=r.uploadAction,m=r.accept,F=r.variant,Y=r.checkboxOptions,J=_()(r,R);return(0,v.jsx)(T.Z,l()({},J));default:return null}}};return(0,v.jsx)(y.Z,l()(l()({form:a,layout:"horizontal"},u),{},{children:t.map(function(n){return(0,v.jsx)(y.Z.Item,l()(l()({name:n.name,label:n.label,rules:n.rules,extra:n.extra,initialValue:n.initial_value},n.form_item_props),{},{children:o(n)}),n.field_id)})}))};W.Z=D},96074:function(oe,W,e){e.d(W,{Z:function(){return s}});var j=e(67294),l=e(93967),L=e.n(l),_=e(53124),B=e(98675),f=e(11568),U=e(14747),b=e(83559),T=e(83262);const y=a=>{const{componentCls:t}=a;return{[t]:{"&-horizontal":{[`&${t}`]:{"&-sm":{marginBlock:a.marginXS},"&-md":{marginBlock:a.margin}}}}}},A=a=>{const{componentCls:t,sizePaddingEdgeHorizontal:u,colorSplit:o,lineWidth:n,textPaddingInline:x,orientationMargin:E,verticalMarginInline:c}=a;return{[t]:Object.assign(Object.assign({},(0,U.Wf)(a)),{borderBlockStart:`${(0,f.bf)(n)} solid ${o}`,"&-vertical":{position:"relative",top:"-0.06em",display:"inline-block",height:"0.9em",marginInline:c,marginBlock:0,verticalAlign:"middle",borderTop:0,borderInlineStart:`${(0,f.bf)(n)} solid ${o}`},"&-horizontal":{display:"flex",clear:"both",width:"100%",minWidth:"100%",margin:`${(0,f.bf)(a.marginLG)} 0`},[`&-horizontal${t}-with-text`]:{display:"flex",alignItems:"center",margin:`${(0,f.bf)(a.dividerHorizontalWithTextGutterMargin)} 0`,color:a.colorTextHeading,fontWeight:500,fontSize:a.fontSizeLG,whiteSpace:"nowrap",textAlign:"center",borderBlockStart:`0 ${o}`,"&::before, &::after":{position:"relative",width:"50%",borderBlockStart:`${(0,f.bf)(n)} solid transparent`,borderBlockStartColor:"inherit",borderBlockEnd:0,transform:"translateY(50%)",content:"''"}},[`&-horizontal${t}-with-text-start`]:{"&::before":{width:`calc(${E} * 100%)`},"&::after":{width:`calc(100% - ${E} * 100%)`}},[`&-horizontal${t}-with-text-end`]:{"&::before":{width:`calc(100% - ${E} * 100%)`},"&::after":{width:`calc(${E} * 100%)`}},[`${t}-inner-text`]:{display:"inline-block",paddingBlock:0,paddingInline:x},"&-dashed":{background:"none",borderColor:o,borderStyle:"dashed",borderWidth:`${(0,f.bf)(n)} 0 0`},[`&-horizontal${t}-with-text${t}-dashed`]:{"&::before, &::after":{borderStyle:"dashed none none"}},[`&-vertical${t}-dashed`]:{borderInlineStartWidth:n,borderInlineEnd:0,borderBlockStart:0,borderBlockEnd:0},"&-dotted":{background:"none",borderColor:o,borderStyle:"dotted",borderWidth:`${(0,f.bf)(n)} 0 0`},[`&-horizontal${t}-with-text${t}-dotted`]:{"&::before, &::after":{borderStyle:"dotted none none"}},[`&-vertical${t}-dotted`]:{borderInlineStartWidth:n,borderInlineEnd:0,borderBlockStart:0,borderBlockEnd:0},[`&-plain${t}-with-text`]:{color:a.colorText,fontWeight:"normal",fontSize:a.fontSize},[`&-horizontal${t}-with-text-start${t}-no-default-orientation-margin-start`]:{"&::before":{width:0},"&::after":{width:"100%"},[`${t}-inner-text`]:{paddingInlineStart:u}},[`&-horizontal${t}-with-text-end${t}-no-default-orientation-margin-end`]:{"&::before":{width:"100%"},"&::after":{width:0},[`${t}-inner-text`]:{paddingInlineEnd:u}}})}},v=a=>({textPaddingInline:"1em",orientationMargin:.05,verticalMarginInline:a.marginXS});var I=(0,b.I$)("Divider",a=>{const t=(0,T.IX)(a,{dividerHorizontalWithTextGutterMargin:a.margin,sizePaddingEdgeHorizontal:0});return[A(t),y(t)]},v,{unitless:{orientationMargin:!0}}),R=function(a,t){var u={};for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&t.indexOf(o)<0&&(u[o]=a[o]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,o=Object.getOwnPropertySymbols(a);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(a,o[n])&&(u[o[n]]=a[o[n]]);return u};const D={small:"sm",middle:"md"};var s=a=>{const{getPrefixCls:t,direction:u,className:o,style:n}=(0,_.dj)("divider"),{prefixCls:x,type:E="horizontal",orientation:c="center",orientationMargin:r,className:w,rootClassName:N,children:S,dashed:G,variant:$="solid",plain:p,style:g,size:M}=a,C=R(a,["prefixCls","type","orientation","orientationMargin","className","rootClassName","children","dashed","variant","plain","style","size"]),i=t("divider",x),[m,F,Y]=I(i),J=(0,B.Z)(M),Q=D[J],te=!!S,k=j.useMemo(()=>c==="left"?u==="rtl"?"end":"start":c==="right"?u==="rtl"?"start":"end":c,[u,c]),ae=k==="start"&&r!=null,ne=k==="end"&&r!=null,se=L()(i,o,F,Y,`${i}-${E}`,{[`${i}-with-text`]:te,[`${i}-with-text-${k}`]:te,[`${i}-dashed`]:!!G,[`${i}-${$}`]:$!=="solid",[`${i}-plain`]:!!p,[`${i}-rtl`]:u==="rtl",[`${i}-no-default-orientation-margin-start`]:ae,[`${i}-no-default-orientation-margin-end`]:ne,[`${i}-${Q}`]:!!Q},w,N),h=j.useMemo(()=>typeof r=="number"?r:/^\d+$/.test(r)?Number(r):r,[r]),d={marginInlineStart:ae?h:void 0,marginInlineEnd:ne?h:void 0};return m(j.createElement("div",Object.assign({className:se,style:Object.assign(Object.assign({},n),g)},C,{role:"separator"}),S&&E!=="vertical"&&j.createElement("span",{className:`${i}-inner-text`,style:d},S)))}}}]);
