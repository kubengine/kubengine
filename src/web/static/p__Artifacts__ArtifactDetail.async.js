"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[469],{59485:function(ue,I,e){var W=e(5574),x=e.n(W),F=e(57132),v=e(47221),L=e(2453),y=e(4393),S=e(83622),E=e(67294),$=e(37246),h=e(74346),f=e(85893),G=v.Z.Panel,Y=function(g){var N=g.yamlText,u=g.title,H=u===void 0?"YAML \u914D\u7F6E":u,p=g.hidden,U=p===void 0?!1:p,z=(0,E.useState)(!1),A=x()(z,2),j=A[0],Z=A[1],b=N,V=function(T){return navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(T):new Promise(function(C,P){var l=document.createElement("textarea");l.value=T,l.style.position="fixed",l.style.top="-9999px",l.style.left="-9999px",l.style.opacity="0",document.body.appendChild(l),l.focus(),l.select();try{var D=document.execCommand("copy");D?C():P(new Error("\u590D\u5236\u5931\u8D25"))}catch(t){P(t)}finally{document.body.removeChild(l)}})},J=function(){V(b).then(function(){Z(!0),setTimeout(function(){return Z(!1)},2e3),L.ZP.success("\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F")}).catch(function(T){console.error("\u590D\u5236\u5931\u8D25:",T);var C=document.querySelector("pre");if(C){var P=document.createRange();P.selectNodeContents(C);var l=window.getSelection();l==null||l.removeAllRanges(),l==null||l.addRange(P)}L.ZP.error("\u81EA\u52A8\u590D\u5236\u5931\u8D25\uFF0C\u8BF7\u624B\u52A8\u590D\u5236\u5185\u5BB9")})};return(0,f.jsx)(y.Z,{title:(0,f.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[H,(0,f.jsx)(S.ZP,{type:"text",icon:(0,f.jsx)(F.Z,{}),disabled:j,onClick:J,children:j?"\u5DF2\u590D\u5236":"\u590D\u5236"})]}),hidden:U,style:{marginTop:16},children:(0,f.jsx)(v.Z,{defaultActiveKey:["1"],bordered:!1,children:(0,f.jsx)(G,{header:"\u67E5\u770B YAML \u5185\u5BB9",children:(0,f.jsx)($.Z,{language:"yaml",style:h.Z,showLineNumbers:!0,lineNumberStyle:{color:"#ccc",fontSize:12},wrapLines:!0,children:b})},"1")})})};I.Z=Y},38123:function(ue,I,e){e.r(I);var W=e(52677),x=e.n(W),F=e(15009),v=e.n(F),L=e(99289),y=e.n(L),S=e(5574),E=e.n(S),$=e(59485),h=e(62832),f=e(63606),G=e(57132),Y=e(48689),q=e(24969),g=e(90930),N=e(88026),u=e(2453),H=e(66309),p=e(83622),U=e(98081),z=e(86738),A=e(86587),j=e(4393),Z=e(74330),b=e(61182),V=e(32983),J=e(96074),R=e(26412),T=e(17788),C=e(25278),P=e(27484),l=e.n(P),D=e(67294),t=e(85893),ce=function(){var Q=(0,N.useParams)(),M=Q.project_name,O=Q.repository_name,K=Q.digest,me=(0,D.useState)(!1),ee=E()(me,2),te=ee[0],ae=ee[1],Ee=(0,D.useState)(!0),ne=E()(Ee,2),ve=ne[0],re=ne[1],fe=(0,D.useState)(""),se=E()(fe,2),De=se[0],Pe=se[1],he=(0,D.useState)(),oe=E()(he,2),i=oe[0],pe=oe[1],Ae=function(a){return navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(a):new Promise(function(r,n){var s=document.createElement("textarea");s.value=a,s.style.position="fixed",s.style.top="-9999px",s.style.left="-9999px",s.style.opacity="0",document.body.appendChild(s),s.focus(),s.select();try{var c=document.execCommand("copy");c?r():n(new Error("\u590D\u5236\u5931\u8D25"))}catch(o){n(o)}finally{document.body.removeChild(s)}})},Te=function(a){var r="";i.type=="CHART"?r="helm pull oci://kubekylin.io/".concat(M,"/").concat(O," --version ").concat(a):r="ctr i pull kubekylin.io/".concat(M,"/").concat(O,":").concat(a),Ae(r).then(function(){ae(!0),setTimeout(function(){return ae(!1)},2e3),u.ZP.success("".concat(r," \u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F"))}).catch(function(n){console.error("\u590D\u5236\u5931\u8D25:",n);var s=document.querySelector("pre");if(s){var c=document.createRange();c.selectNodeContents(s);var o=window.getSelection();o==null||o.removeAllRanges(),o==null||o.addRange(c)}u.ZP.error("\u81EA\u52A8\u590D\u5236\u5931\u8D25\uFF0C\u8BF7\u624B\u52A8\u590D\u5236\u5185\u5BB9")})},X=function(){var d=y()(v()().mark(function a(){var r,n,s,c,o,k;return v()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return re(!0),m.next=3,h.Z.ArtifactsController.get_artifact(M||"",encodeURIComponent(encodeURIComponent(O||"")),K||"");case 3:if(r=m.sent,n=r.code,s=r.data,n!=200){m.next=17;break}if(pe(s),s.type!="CHART"){m.next=15;break}return m.next=11,h.Z.ArtifactsController.chart_values(M||"",encodeURIComponent(encodeURIComponent(O||"")),K||"");case 11:c=m.sent,o=c.code,k=c.data,o==200?Pe(k):u.ZP.error("\u83B7\u53D6chart values.yaml\u5931\u8D25");case 15:m.next=18;break;case 17:u.ZP.error("\u83B7\u53D6Tags\u5931\u8D25");case 18:re(!1);case 19:case"end":return m.stop()}},a)}));return function(){return d.apply(this,arguments)}}();(0,D.useEffect)(function(){X()},[]);var Ce=function(){var d=y()(v()().mark(function a(r){var n,s;return v()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return B(!0),o.next=3,h.Z.ArtifactsController.del_artifact_tag(M||"",encodeURIComponent(encodeURIComponent(O||"")),K||"",r);case 3:n=o.sent,s=n.code,s==200?(u.ZP.success("Tag\u5220\u9664\u6210\u529F"),X()):u.ZP.error("\u5220\u9664Tag\u5931\u8D25"),B(!1);case 7:case"end":return o.stop()}},a)}));return function(r){return d.apply(this,arguments)}}(),Me=[{title:"\u540D\u79F0",dataIndex:"name",key:"name",width:100,render:function(a){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(H.Z,{color:a=="CHART"?"cyan":"blue",children:a}),(0,t.jsx)(p.ZP,{icon:te?(0,t.jsx)(f.Z,{}):(0,t.jsx)(G.Z,{}),onClick:function(){return Te(a)},children:te?"\u5DF2\u590D\u5236":"\u590D\u5236\u62C9\u53D6\u547D\u4EE4"})]})}},{title:"\u63A8\u9001\u65F6\u95F4",dataIndex:"push_time",key:"push_time",width:150,render:function(a){return l()(a).format("YYYY-MM-DD HH:mm:ss")}},{title:"\u62C9\u53D6\u65F6\u95F4",dataIndex:"pull_time",key:"pull_time",width:150,render:function(a){return l()(a).format("YYYY-MM-DD HH:mm:ss")}},{title:"\u64CD\u4F5C",key:"action",width:200,render:function(a,r){return(0,t.jsx)(U.Z,{size:"small",children:(0,t.jsx)(z.Z,{title:"\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u4E2ATag\u5417\uFF1F",onConfirm:function(){return Ce(r.name)},okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",children:(0,t.jsx)(p.ZP,{type:"text",size:"small",icon:(0,t.jsx)(Y.Z,{}),danger:!0,children:"\u5220\u9664"})})})}}],Oe=function(){de(!0),w.resetFields()},le=function(){de(!1),B(!1)},ye=(0,D.useState)(!1),_e=E()(ye,2),ge=_e[0],de=_e[1],je=(0,D.useState)(!1),ie=E()(je,2),Re=ie[0],B=ie[1],Be=A.Z.useForm(),Ie=E()(Be,1),w=Ie[0],xe=function(){var d=y()(v()().mark(function a(){var r,n,s,c,o;return v()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.prev=0,_.next=3,w.validateFields();case 3:if(r=_.sent,n=r.tagName.trim(),s=i.tags.some(function(m){return m.name===n}),!s){_.next=9;break}return u.ZP.warning("TAG ".concat(n," \u5DF2\u5B58\u5728\uFF0C\u8BF7\u52FF\u91CD\u590D\u6DFB\u52A0")),_.abrupt("return");case 9:return B(!0),_.next=12,h.Z.ArtifactsController.add_artifact_tag(M||"",encodeURIComponent(encodeURIComponent(O||"")),K||"",n);case 12:c=_.sent,o=c.code,o===201?(u.ZP.success("TAG ".concat(n," \u6DFB\u52A0\u6210\u529F")),X(),le()):u.ZP.error("\u6DFB\u52A0 TAG \u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),_.next=21;break;case 17:_.prev=17,_.t0=_.catch(0),console.error("\u6DFB\u52A0 TAG \u51FA\u9519\uFF1A",_.t0),u.ZP.error("\u6DFB\u52A0 TAG \u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u8F93\u5165");case 21:return _.prev=21,B(!1),_.finish(21);case 24:case"end":return _.stop()}},a,null,[[0,17,21,24]])}));return function(){return d.apply(this,arguments)}}();return(0,t.jsxs)(g._z,{children:[(0,t.jsxs)(j.Z,{title:"Tags",children:[(0,t.jsx)(U.Z,{style:{width:"100%",justifyContent:"flex-end"},children:(0,t.jsx)(p.ZP,{type:"text",icon:(0,t.jsx)(q.Z,{}),onClick:Oe,children:"\u6DFB\u52A0TAG"})}),(0,t.jsx)(Z.Z,{spinning:ve,children:(0,t.jsx)(b.Z,{dataSource:i==null?void 0:i.tags,columns:Me,rowKey:"id",pagination:!1,scroll:{x:1100},size:"middle",locale:{emptyText:(0,t.jsx)(V.Z,{description:"\u672A\u53D1\u73B0\u4EFB\u4F55 Tag!"})}})})]}),(0,t.jsx)(J.Z,{}),(0,t.jsx)(j.Z,{title:"\u5C5E\u6027\u603B\u89C8",children:(0,t.jsxs)(R.Z,{column:1,bordered:!0,size:"small",contentStyle:{whiteSpace:"pre-wrap"},children:[Object.entries((i==null?void 0:i.extra_attrs)||{}).map(function(d){var a=E()(d,2),r=a[0],n=a[1];if(r!=="annotations")return(0,t.jsx)(R.Z.Item,{label:r,span:2,children:"".concat(x()(n)==="object"?JSON.stringify(n):n)})}),Object.entries((i==null?void 0:i.annotations)||{}).map(function(d){var a=E()(d,2),r=a[0],n=a[1];return(0,t.jsx)(R.Z.Item,{label:r,span:2,children:"".concat(x()(n)==="object"?JSON.stringify(n,null,2):n)})})]})}),(0,t.jsx)($.Z,{yamlText:De,title:"values.yaml",hidden:(i==null?void 0:i.type)!="CHART"}),(0,t.jsx)(T.Z,{title:"\u65B0\u589E TAG",open:ge,onOk:xe,onCancel:le,confirmLoading:Re,destroyOnHidden:!0,maskClosable:!1,width:400,children:(0,t.jsx)(A.Z,{form:w,layout:"vertical",initialValues:{tagName:""},children:(0,t.jsx)(A.Z.Item,{name:"tagName",label:"TAG \u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165 TAG \u540D\u79F0"},{pattern:/^[a-zA-Z0-9_\-.]+$/,message:"TAG \u540D\u79F0\u4EC5\u5141\u8BB8\u5B57\u6BCD\u3001\u6570\u5B57\u3001\u4E0B\u5212\u7EBF\u3001\u6A2A\u6760\u3001\u70B9"},{max:64,message:"TAG \u540D\u79F0\u957F\u5EA6\u4E0D\u8D85\u8FC7 64 \u4E2A\u5B57\u7B26"}],children:(0,t.jsx)(C.Z,{placeholder:"\u8BF7\u8F93\u5165 TAG \u540D\u79F0\uFF08\u5982\uFF1Av1.0.0\u3001latest\uFF09",maxLength:64})})})})]})};I.default=ce}}]);
